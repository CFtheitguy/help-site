        htmlBody  : form.get("body-html") || "",
        attachments: []
      };

      // Grab every attachment-* file, base64 encode it, and include it
      for (const [key, val] of form.entries()) {
        if (key.startsWith("attachment-") && val instanceof File) {
          const ab  = await val.arrayBuffer();
          const b64 = btoa(String.fromCharCode(...new Uint8Array(ab)));
          payload.attachments.push({
            filename    : val.name || "attachment",
            contentType : val.type || "application/octet-stream",
            size        : val.size || ab.byteLength || 0,
            base64      : b64
          });
        }
      }

      // Forward to your main API (linear-desk worker)
      const upstream = await fetch("https://api.help.linearit.co/admin/email/from-webhook", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          "x-api-key": env.API_KEY  // must match what your main API checks
        },
        body: JSON.stringify(payload)
      });

      const text = await upstream.text();
      return new Response(text, { status: upstream.status, headers: { "Content-Type": "application/json" } });
    } catch (e) {
      return new Response(JSON.stringify({ error: String(e) }), { status: 500, headers
